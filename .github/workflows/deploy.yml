   name: Deploy React Frontend

   on:
     push:
       branches: [ master ]  # 或者您的主分支名称

   jobs:
     build-and-deploy:
       runs-on: ubuntu-latest
       
       steps:
       - name: Checkout repository
         uses: actions/checkout@v2

       - name: Set up Node.js
         uses: actions/setup-node@v2
         with:
           node-version: '18.20.4'  # 使用与您项目兼容的 Node.js 版本

       - name: Install dependencies
         run: npm ci

       - name: Build project
         run: npm run build

       - name: Deploy to server
         uses: appleboy/scp-action@master
         with:
           host: ${{ secrets.HOST }}
           username: ${{ secrets.USERNAME }}
           password: ${{ secrets.PASSWORD }}
           port: ${{ secrets.PORT }}
           source: "build/*"
           target: "/data/aiweb/moduchat.clinet/"
           strip_components: 1

       - name: Execute remote commands
         uses: appleboy/ssh-action@master
         with:
           host: ${{ secrets.HOST }}
           username: ${{ secrets.USERNAME }}
           password: ${{ secrets.PASSWORD }}
           port: ${{ secrets.PORT }}
           script: |
             cd /data/aiweb/
             docker-compose up -d --build